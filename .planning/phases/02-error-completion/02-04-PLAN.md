---
phase: 02-error-completion
plan: 04
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - src/components/auth/CoachAuth.tsx
  - src/components/auth/StudentAuth.tsx
  - src/pages/Dashboard.tsx
  - src/pages/CoachDashboard.tsx
  - src/pages/Tasks.tsx
autonomous: true

must_haves:
  truths:
    - "Auth form submit buttons show spinner while authenticating"
    - "Dashboard shows skeleton placeholders while loading stats data"
    - "Tasks page shows skeleton while loading groups/members"
  artifacts:
    - path: "src/components/auth/CoachAuth.tsx"
      provides: "Coach auth with LoadingButton component"
      contains: "LoadingButton"
    - path: "src/components/auth/StudentAuth.tsx"
      provides: "Student auth with LoadingButton component"
      contains: "LoadingButton"
    - path: "src/pages/Dashboard.tsx"
      provides: "Dashboard with skeleton loading state"
      contains: "DashboardSkeleton"
    - path: "src/pages/CoachDashboard.tsx"
      provides: "Coach dashboard with skeleton loading state"
      contains: "DashboardSkeleton"
  key_links:
    - from: "src/components/auth/CoachAuth.tsx"
      to: "src/components/ui/loading-button.tsx"
      via: "imports LoadingButton"
      pattern: "import.*LoadingButton.*from.*loading-button"
    - from: "src/pages/Dashboard.tsx"
      to: "src/components/skeletons/DashboardSkeleton.tsx"
      via: "imports DashboardSkeleton"
      pattern: "import.*DashboardSkeleton.*from.*skeletons"
---

<objective>
Adopt LoadingButton and skeleton components created in Plan 02-01 across auth forms and dashboards.

Purpose: Fulfill ERR-03 success criteria by ensuring loading components are actually IN USE - "All buttons and forms show loading indicators" and "Data fetching displays skeleton/spinner states". Plan 02-01 creates the components; this plan integrates them.

Output: Auth forms use LoadingButton instead of manual Button+Loader2, dashboards show DashboardSkeleton during data fetch.
</objective>

<execution_context>
@/Users/haokunyang/.claude/get-shit-done/workflows/execute-plan.md
@/Users/haokunyang/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-error-completion/02-CONTEXT.md
@.planning/phases/02-error-completion/02-01-PLAN.md

Reference the components created in 02-01:
@src/components/ui/loading-button.tsx (created by 02-01)
@src/components/skeletons/DashboardSkeleton.tsx (created by 02-01)
@src/components/skeletons/TaskListSkeleton.tsx (created by 02-01)

Files to modify:
@src/components/auth/CoachAuth.tsx
@src/components/auth/StudentAuth.tsx
@src/pages/Dashboard.tsx
@src/pages/CoachDashboard.tsx
@src/pages/Tasks.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace manual loading buttons with LoadingButton in auth forms</name>
  <files>
src/components/auth/CoachAuth.tsx
src/components/auth/StudentAuth.tsx
  </files>
  <action>
Replace the manual Button + Loader2 pattern with the new LoadingButton component in both auth forms.

**CoachAuth.tsx changes:**
1. Update imports: Remove `Loader2` from lucide-react imports (still needed for Google button)
2. Add import: `import { LoadingButton } from "@/components/ui/loading-button";`
3. Replace line 190-193 (email submit button):
   FROM:
   ```tsx
   <Button type="submit" className="w-full" disabled={isLoading}>
     {isLoading && <Loader2 className="w-4 h-4 mr-2 animate-spin" />}
     {isLogin ? "Sign In" : "Create Account"}
   </Button>
   ```
   TO:
   ```tsx
   <LoadingButton type="submit" className="w-full" isLoading={isLoading}>
     {isLogin ? "Sign In" : "Create Account"}
   </LoadingButton>
   ```
4. Keep Loader2 import for line 148 (Google OAuth button uses `googleLoading` state separately)

**StudentAuth.tsx changes:**
1. Update imports: Remove `Loader2` from lucide-react imports
2. Add import: `import { LoadingButton } from "@/components/ui/loading-button";`
3. Replace line 193-196 (email submit button):
   FROM:
   ```tsx
   <Button type="submit" className="w-full" disabled={isLoading}>
     {isLoading && <Loader2 className="w-4 h-4 mr-2 animate-spin" />}
     {isLogin ? "Sign In" : "Create Account"}
   </Button>
   ```
   TO:
   ```tsx
   <LoadingButton type="submit" className="w-full" isLoading={isLoading}>
     {isLogin ? "Sign In" : "Create Account"}
   </LoadingButton>
   ```

Note: Keep the Button import as it's still used for other non-loading buttons in both components.
  </action>
  <verify>
- `grep -n "LoadingButton" src/components/auth/CoachAuth.tsx` shows import and usage
- `grep -n "LoadingButton" src/components/auth/StudentAuth.tsx` shows import and usage
- `npx tsc --noEmit` passes without errors
- Manual test: Sign in form shows spinner in button text area while submitting
  </verify>
  <done>
Auth forms use LoadingButton component for submit buttons, showing integrated spinner during async operations.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add skeleton loading states to dashboards</name>
  <files>
src/pages/Dashboard.tsx
src/pages/CoachDashboard.tsx
  </files>
  <action>
Replace the simple Loader2 spinner with DashboardSkeleton for a better loading experience.

**Dashboard.tsx changes:**
1. Add import: `import { DashboardSkeleton } from "@/components/skeletons/DashboardSkeleton";`
2. Add loading state: After line 18, add `const [loading, setLoading] = useState(true);`
3. Update fetchData to track loading:
   - Add `setLoading(true);` at start of fetchData
   - Add `setLoading(false);` in a finally block
4. Add early return for loading state before the main return (around line 54):
   ```tsx
   if (loading) {
     return (
       <div className="space-y-8">
         <div>
           <div className="h-10 w-64 bg-muted animate-pulse rounded" />
           <div className="h-4 w-48 bg-muted animate-pulse rounded mt-2" />
         </div>
         <DashboardSkeleton />
       </div>
     );
   }
   ```

**CoachDashboard.tsx changes:**
1. Add import: `import { DashboardSkeleton } from "@/components/skeletons/DashboardSkeleton";`
2. Replace the loading return block (lines 183-189):
   FROM:
   ```tsx
   if (loading || groupsLoading) {
     return (
       <div className="flex items-center justify-center h-64">
         <Loader2 className="w-8 h-8 animate-spin text-cta-primary" />
       </div>
     );
   }
   ```
   TO:
   ```tsx
   if (loading || groupsLoading) {
     return (
       <div className="space-y-8 pb-20">
         <div className="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
           <div>
             <div className="h-8 w-40 bg-muted animate-pulse rounded" />
             <div className="h-4 w-48 bg-muted animate-pulse rounded mt-2" />
           </div>
         </div>
         <DashboardSkeleton />
       </div>
     );
   }
   ```
3. Remove `Loader2` from lucide-react imports if no longer used elsewhere in the file (check first - it's used in dialogs, so keep it)
  </action>
  <verify>
- `grep -n "DashboardSkeleton" src/pages/Dashboard.tsx` shows import and usage
- `grep -n "DashboardSkeleton" src/pages/CoachDashboard.tsx` shows import and usage
- `npx tsc --noEmit` passes without errors
- Manual test: Navigate to /dashboard, briefly see skeleton cards before data loads
  </verify>
  <done>
Dashboards show skeleton placeholders that mimic stats card layout during initial data fetch.
  </done>
</task>

<task type="auto">
  <name>Task 3: Add skeleton loading state to Tasks page</name>
  <files>src/pages/Tasks.tsx</files>
  <action>
Replace the simple Loader2 spinner with TaskListSkeleton for better loading UX.

**Tasks.tsx changes:**
1. Add import: `import { TaskListSkeleton } from "@/components/skeletons/TaskListSkeleton";`
2. Replace the loading return block (lines 487-493):
   FROM:
   ```tsx
   if (loading || groupsLoading) {
     return (
       <div className="flex items-center justify-center h-64">
         <Loader2 className="w-8 h-8 animate-spin text-cta-primary" />
       </div>
     );
   }
   ```
   TO:
   ```tsx
   if (loading || groupsLoading) {
     return (
       <div className="space-y-8 pb-20">
         <div>
           <div className="h-8 w-56 bg-muted animate-pulse rounded" />
           <div className="h-4 w-72 bg-muted animate-pulse rounded mt-2" />
         </div>
         <div className="space-y-4">
           <TaskListSkeleton />
           <TaskListSkeleton />
         </div>
       </div>
     );
   }
   ```

Note: Keep `Loader2` import - it's still used extensively in dialog buttons throughout the file (lines 241, 270, 335, 813, 1005, 1029).
  </action>
  <verify>
- `grep -n "TaskListSkeleton" src/pages/Tasks.tsx` shows import and usage
- `npx tsc --noEmit` passes without errors
- Manual test: Navigate to /dashboard/tasks, see skeleton list items before groups load
  </verify>
  <done>
Tasks page shows skeleton list placeholders during group/member data fetch.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:
1. Run `npx tsc --noEmit` - no TypeScript errors
2. Run `npm run build` - build succeeds
3. Verify adoption with grep:
   - `grep -r "LoadingButton" src/components/auth/` shows usage in both auth files
   - `grep -r "DashboardSkeleton" src/pages/` shows usage in Dashboard files
   - `grep -r "TaskListSkeleton" src/pages/` shows usage in Tasks file
4. Manual smoke test:
   - Auth: Submit login form, see spinner in button
   - Dashboard: Refresh page, see skeleton cards briefly
   - Tasks: Navigate to tasks, see skeleton list briefly
</verification>

<success_criteria>
- LoadingButton used in CoachAuth.tsx and StudentAuth.tsx submit buttons
- DashboardSkeleton used in Dashboard.tsx and CoachDashboard.tsx loading states
- TaskListSkeleton used in Tasks.tsx loading state
- All files compile and build without errors
- Loading states show skeleton UI instead of centered spinner
</success_criteria>

<output>
After completion, create `.planning/phases/02-error-completion/02-04-SUMMARY.md`
</output>
